import bcrypt from "bcryptjs";
import { RegisterFormData } from "./types";

export const hashData = async (data: string) => {
  const saltRounds = 10;
  const hashedPassword = await bcrypt.hash(data, saltRounds);

  return hashedPassword;
};

export const sanitizeData = (data: RegisterFormData) => {
  const unescapeHtml = (input: string): string => {
    const textArea = document.createElement("textarea");
    textArea.innerHTML = input;
    return textArea.value;
  };

  const sanitizeString = (input: string): string => {
    const unescaped = unescapeHtml(input);
    return unescaped.replace(/<script.*?>.*?<\/script>/gi, "").trim();
  };

  return {
    email: sanitizeString(data.email),
    password: sanitizeString(data.password),
    confirmPassword: sanitizeString(data.confirmPassword),
  };
};
