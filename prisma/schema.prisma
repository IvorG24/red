generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["multiSchema"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
  schemas   = ["user_schema"]
}

enum Role {
  MEMBER
  ADMIN
@@schema("user_schema")
}

model user_table {
  user_id         String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_date_created DateTime @default(now())
  user_first_name String?
  user_last_name  String?
  user_email      String   @unique
  user_password   String
  user_role       Role     @default(MEMBER)
  user_step       String

  referral_Link       user_referal_link_table[]
  referals         user_referal_table[]

  @@schema("user_schema")
}

model user_referal_link_table {
  user_referal_link_id         String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_referal_link       String
  user_referal_link_user_id    String      @db.Uuid

  user                  user_table  @relation(fields: [user_referal_link_user_id], references: [user_id], onDelete: Cascade, onUpdate: Cascade)
  user_referal_table user_referal_table[]

  @@schema("user_schema")
}

model user_referal_table {
  user_referal_id        String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_referal_user_id   String                @db.Uuid
  user_referal_referal_link_id   String                @db.Uuid

  user                   user_table           @relation(fields: [user_referal_user_id], references: [user_id], onDelete: Cascade, onUpdate: Cascade)
  referal                user_referal_link_table @relation(fields: [user_referal_referal_link_id], references: [user_referal_link_id], onDelete: Cascade, onUpdate: Cascade)

  @@schema("user_schema")
}
